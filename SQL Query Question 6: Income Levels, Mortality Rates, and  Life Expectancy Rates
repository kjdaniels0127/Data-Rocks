
Select life expectancy for 12 select countries from 1992 to 2022.
Calculate estimate average life expectancy based on lower bound, estimate, and upper bound.
The case function is used to include a 60 column to assist in calculating the total life expectancy for life expectancy years after 60.
SELECT iso3 AS country_code, country_name, year, 
indicator_name AS measuring_factor,
lower_bound AS lower_range,
estimate AS mid_range,
upper_bound AS upper_range,
ROUND((lower_bound + estimate + upper_bound) / 3,2) AS avg_value,
CASE 
  WHEN indicator_name = 'Healthy life expectancy (HALE) at age 60 (years)'
  THEN 60 
  ELSE 0 
END AS calculated_avg_value
FROM `social-factors-and-healthcare.world_health_organization_data.World Health Data` 
WHERE iso3 IN (
'AFG','CAN','FRA', 'NGA', 'USA','FRA',
'MLI','COL', 'COG','DOM','GHA','IND','ZAF'
)
AND year BETWEEN 1992 and 2022
AND indicator_name LIKE '%life expectancy%'

Select mortality rates for neonatals for 12 select countries in between 1992 and 2022.
Calculate the average mortality rates for neonatal grouped by country info and year. 
SELECT indicator_name,
  country_code,
  country_name, 
  year,
  ROUND(AVG(value),2) AS average_mortality_value
 FROM `bigquery-public-data.world_bank_wdi.indicators_data` 
 WHERE indicator_name LIKE '%Mortality rate, neonatal%'
  AND country_code IN (
'CAN','NGA', 'FRA', 'AFG', 'MLI', 'USA',
'COL', 'COG', 'DOM', 'GHA', 'IND', 'ZAF'
)
  AND year BETWEEN 1992 AND 2022
GROUP BY 
  country_name, country_code, year, indicator_name

Select mortality rates for infant for 12 select countries in between 1992 and 2022.
Calculate the average mortality rates for infants grouped by country info and year.
SELECT indicator_name,
  country_code,
  country_name, 
  year,
  ROUND(AVG(value),2) AS average_mortality_value
 FROM `bigquery-public-data.world_bank_wdi.indicators_data` 
 WHERE indicator_name LIKE '%Mortality rate, infant%'
  AND country_code IN (
'CAN','NGA', 'FRA', 'AFG', 'MLI', 'USA', 
'COL', 'COG', 'DOM', 'GHA', 'IND', 'ZAF'
)
  AND year BETWEEN 1992 AND 2022
GROUP BY 
  country_name, country_code, year, indicator_name 

Select mortality rates for less than 5 year olds for 12 select countries in between 1992 and 2022.
Calculate the average mortality rates for less than 5 year olds grouped by country info and year.
SELECT indicator_name,
  country_code,
  country_name, 
  year,
  ROUND(AVG(value),2) AS average_mortality_value
 FROM `bigquery-public-data.world_bank_wdi.indicators_data` 
 WHERE indicator_name LIKE '%Mortality rate, under-5%'
  AND country_code IN (
'CAN','NGA', 'FRA', 'AFG', 'MLI', 'USA', 
'COL', 'COG', 'DOM', 'GHA', 'IND', 'ZAF'
)
  AND year BETWEEN 1992 AND 2022
GROUP BY 
  country_name, country_code, year, indicator_name

Select mortality rates for adults for 12 select countries in between 1992 and 2022.
Calculate the average mortality rates for adults grouped by country info and year.
SELECT indicator_name,
  country_code,
  country_name, 
  year,
  ROUND(AVG(value),2) AS average_mortality_value
 FROM `bigquery-public-data.world_bank_wdi.indicators_data` 
 WHERE indicator_name LIKE '%Mortality rate, adult%'
  AND country_code IN (
'CAN','NGA', 'FRA', 'AFG', 'MLI', 'USA', 
'COL', 'COG', 'DOM', 'GHA', 'IND', 'ZAF'
)
  AND year BETWEEN 1992 AND 2022
GROUP BY 
  country_name, country_code, year, indicator_name

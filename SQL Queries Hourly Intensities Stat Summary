## Hourly Intensities statistical summary March 2016-April 2016

Statistical summary includes minimum, quartile 1, average, quartile 3, and maximum of the 

CREATE OR REPLACE TABLE `wellness-tech-play-it-smart.Fitbitdata_03_12_16_to_04_11_16.hourly_intensities_03_16_to_04_16_stat_summary` AS

WITH intensities_with_quartiles AS (
  SELECT 
  Id,
  TotalIntensity,
    PERCENTILE_CONT(TotalIntensity, 0.25) OVER (PARTITION BY ID) AS quartile_1_intensities,
    PERCENTILE_CONT(TotalIntensity, 0.75) OVER (PARTITION BY ID) AS quartile_3_intensities,
FROM `wellness-tech-play-it-smart.Fitbitdata_03_12_16_to_04_11_16.Hourly_Intensities 03_12_16_to_04_11_16` 
)

SELECT
  Id,
  MIN(TotalIntensity) AS min_intensity,
  ROUND(AVG(TotalIntensity), 2) AS avg_intensity,
  MAX(TotalIntensity) AS max_intensity,
  ANY_VALUE(quartile_1_intensities) AS quartile_1_intensities,
  ANY_VALUE(quartile_3_intensities) AS quartile_3_intensities
FROM intensities_with_quartiles
GROUP BY ID;

## Hourly Intensities statistical summary April 2016-May 2016

CREATE OR REPLACE TABLE `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.stat_summary_04_16_to_05_16_hourly_intensity` AS

WITH intensities_with_quartiles AS (
  SELECT 
  Id,
  TotalIntensity,
    PERCENTILE_CONT(TotalIntensity, 0.25) OVER (PARTITION BY ID) AS quartile_1_intensities,
    PERCENTILE_CONT(TotalIntensity, 0.75) OVER (PARTITION BY ID) AS quartile_3_intensities,
FROM `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.Hourly_Intensities 04_12_16 to 05_11_16`
)

SELECT
  Id,
  MIN(TotalIntensity) AS min_intensity,
  ROUND(AVG(TotalIntensity), 2) AS avg_intensity,
  MAX(TotalIntensity) AS max_intensity,
  ANY_VALUE(quartile_1_intensities) AS quartile_1_intensities,
  ANY_VALUE(quartile_3_intensities) AS quartile_3_intensities
FROM intensities_with_quartiles
GROUP BY ID;

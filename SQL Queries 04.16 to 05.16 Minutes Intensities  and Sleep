Utilized the sleep minutes table for April 2016-May 2016 mentioned in the sleep and calories section. The table name is called total_sleep_minutes_04_16_to_05_16.

##Step 1: Create early 04.2016 Intensities table with average intensity per day

CREATE OR REPLACE TABLE `wellness-tech-play-it-smart.Fitbitdata_03_12_16_to_04_11_16.minute_intensity_early_04_16` AS 
SELECT ID,
SUM(Intensity) AS total_intensity,
COUNT(DISTINCT CASE WHEN Intensity > 0 THEN _activityday END) AS active_days,
IFNULL(
ROUND(SUM(Intensity) / NULLIF (COUNT(DISTINCT CASE WHEN Intensity > 0 THEN _activityday END), 0), 2),0
)
AS avg_intensity_per_day
FROM `wellness-tech-play-it-smart.Fitbitdata_03_12_16_to_04_11_16.Minutes 04_01_16 to 04_11_16` 
GROUP BY ID; 

## Step 2: Create the minutes intensities table for early 05.2016 data.

CREATE OR REPLACE TABLE `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.early_05_2016_intensity` AS 
SELECT ID,
activity_day AS activity_day_by_id,
SUM(Intensity) AS total_intensity
FROM `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.Intensities_minutes_05_01_16 to_05_12_16`
GROUP BY ID, activity_day; 

## Step 3: Combine the created tables minutes intensitie tables of late 04.2016 and early 05.2016 to create a minute intensity 04.2016 to 05.2016

CREATE OR REPLACE TABLE `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.minute_intensity_04_16_to_05_16`  AS 
SELECT ID,
  SUM(active_days) AS total_active_days,
  SUM(total_intensity) AS total_intensity_sum,
IFNULL(
  ROUND(SUM(total_intensity) * 1.0/NULLIF(SUM(active_days), 0),2),
  0
) 
AS weighted_avg_intensity_per_day

## early May 2016 data 
 FROM (
    SELECT ID, 
    active_days,
    total_intensity
    FROM `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.minute_intensity_early_05_2016`
 UNION ALL 
  
  ## late April 2016 data
    SELECT ID,
    active_days,
    total_intensity
    FROM `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.minute_intensity_late_04_2016`
 )
GROUP BY ID; 

##Step 4: Joining together matching IDs from calories id day 04.2016 to 05.2016 and total sleep minutes 04.2016 to 05.2016

SELECT DISTINCT calories.ID,
calories.avg_calories_by_id,
sleep.sleep_minutes_per_day
 FROM `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.calories_id_by_day_04_16_to_05_16` AS calories
 INNER JOIN `wellness-tech-play-it-smart.Fitbitdata_04_12_16_to_05_11_16.total_sleep_minutes_04_16_to_05_16` AS sleep
ON calories.ID = sleep.ID; 
